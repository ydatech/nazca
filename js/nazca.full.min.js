window.nzc_fonts=window.nzc_fonts?window.nzc_fonts:[["Arial","",true],["Georgia","",true],["Times New Roman","",true]];var nzc_textAlign={LEFT:1,CENTER:2,RIGHT:3};var nzc_workspaceTypes={FACEBOOK:{id:1,width:800,height:669,ratio:1.1951871657754}};function nzc_escapeHtml(a){_times=function(b,e){for(var c=0,d="";c<e;c++){d+=b}return d};a=a.replace(/</g,"&lt;").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(b){return _times("&nbsp;",b.length-1)+" "});return a}function nzc_loadFontStylesheet(d){var c=null;if(typeof(d)==="string"){for(var f in nzc_fonts){if(nzc_fonts[f][0]===d){c=f;break}}}else{c=d}if(c===null){return false}var e=nzc_fonts[c][1];var b=nzc_fonts[c][2];if(!b&&e){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",e);document.getElementsByTagName("head")[0].appendChild(a);nzc_fonts[c][2]=true}return true}(function(y){var J="0.1.0";var z={};var e={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,CTRL:17};var f={IMAGE:1,TEXT:2};var w={workspace:nzc_workspaceTypes.FACEBOOK,ratio_lock:true,resize_width_limit:0,resize_height_limit:0};var I=false;if(("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch){I=true}console.log("Touch Events: "+(I?"supported":"not supported"));var r=0;var t={};var G=0;y.fn.nazca=function(M){if(typeof(M)==="object"||!M){return z.init.apply(this,arguments)}else{if(z[M]){return z[M].apply(this,Array.prototype.slice.call(arguments,1))}else{y.error("Method "+M+" does not exists.")}}};z.init=function(N){var M=y.extend({},w,N);y("body").addClass("not-selectable");return this.each(function(){var V=y(this);if(V.hasClass("nazca-workspace")){return false}V.addClass("nazca-workspace");var P=V.innerWidth();var Q=V.innerHeight();var X=P/Q;if(w.workspace.ratio<X){P=Q*w.workspace.ratio;V.innerWidth(P)}else{Q=P*w.workspace.ratio;V.innerHeight(Q)}var W=y('<div class="nazca-elements"></div>').appendTo(V);var Y=y('<div class="nazca-resize-wrap" style="display:none;"><div class="nazca-resize-draggable"></div><a class="nazca-resize-control top-left"></a><a class="nazca-resize-control left"></a><a class="nazca-resize-control top-right"></a><a class="nazca-resize-control bottom-left"></a><a class="nazca-resize-control right"></a><a class="nazca-resize-control bottom-right"></a></div>').appendTo(V);var T=y('<div class="nazca-editor-controls" style="display:none;"></div>').appendTo(V);var S=y('<div class="nazca-align-controls"><div class="nazca-align vertical na-vl"></div><div class="nazca-align vertical na-vr"></div><div class="nazca-align vertical na-vc"></div></div>').appendTo(V);var U=++r;G++;t[U]={$nazca:V,$nazca_elements:W,$nazca_resize_wrap:Y,$nazca_editor_controls:T,$nazca_align_controls:S,resize_wrap_border_width:Math.round(parseFloat(Y.css("border-left-width"))),editor_controls_height:T.height()+10,opts:M,elements:[],active_element_id:0,element_last_id:0,scale_delta:P/w.workspace.width};var O=t[U];V.attr("data-nazca-id",U);var R=function(){Y.hide();T.hide();var aa=O.$nazca_resize_wrap.find(".nazca-resize-draggable");aa.nzc_textarea("remove");if(O.active_element_id){var Z=D(U,O.active_element_id);if(Z&&Z.type==f.TEXT&&Z.desc==""){A(U,O.active_element_id)}O.active_element_id=0}};y(document).bind("mousedown.nazca dragstart.nazca touchstart.nazca",function(aa){if(!O.active_element_id){return true}var Z=y(aa.target);if(!Z.parents(".nazca-resize-wrap").length&&!Z.hasClass("nazca-resize-wrap")&&!Z.parents(".element").length&&!Z.hasClass("element")&&!Z.parents(".nazca-editor-controls").length&&!Z.hasClass("nazca-editor-controls")){R()}});y(document).bind("keydown.nazca",function(Z){switch(Z.which){case e.ESCAPE:R();break;case e.DELETE:break;default:break}})})};z.reset=function(){y(document).unbind("mousedown.nazca dragstart.nazca touchstart.nazca keydown.nazca");return this.each(function(){var M=y(this);var N=M.find(".nazca-elements");if(N){E(N)}delete t[parseInt(M.attr("data-nazca-id"))];G--;if(!G){y("body").removeClass("not-selectable")}})};function E(M){M.empty()}z.exportJSON=function(){var M=[];this.each(function(){var P=y(this);var N=P.attr("data-nazca-id");var R=[];for(var Q in t[N].elements){var O=y.extend({},t[N].elements[Q]);delete O.css;R.push(O)}M.push({type:t[N].opts.workspace.id,data:R})});return M};z.addElements=function(M){return this.each(function(){var O=y(this);var N=O.attr("data-nazca-id");if(!N){return false}x(N,M)})};z.addNewElement=function(M){return this.each(function(){var Q=y(this);var O=Q.attr("data-nazca-id");if(!O){return false}var R=t[O];var S=R.scale_delta;var U=Math.round(Q.width()/S);var T=Math.round(Q.height()/S);M.x=0;M.y=0;if(M.type==f.IMAGE){var N=M.width/M.height;if((U/T)>N){M.width=U;M.height=Math.round(M.width/N)}else{M.height=T;M.width=Math.round(M.height*N)}if(M.width>U){M.x=Math.round((U-M.width)/2)}if(M.height>T){M.y=Math.round((T-M.height)/2)}}else{if(M.type==f.TEXT){M.x=Math.round((U-M.width)/2);M.y=Math.round((T-M.fontSize)/2)}}var P=x(O,M);if(P){L(O,P)}})};z.redrawElement=function(M){return this.each(function(){var O=y(this);var N=O.attr("data-nazca-id");if(!N){return false}var P=D(N,M);if(P){o(N,P)}})};z.getElementData=function(O){var N=y(this);var M=N.attr("data-nazca-id");if(!M){return false}return D(M,O)};z.setElementAttr=function(M,N,O){return this.each(function(){var Q=y(this);var P=Q.attr("data-nazca-id");if(!P){return false}H(P,M,N,O||null)})};z.removeElement=function(M){return this.each(function(){var O=y(this);var N=O.attr("data-nazca-id");if(!N){return false}A(N,M)})};z.moveElement=function(M,N){return this.each(function(){var P=y(this);var O=P.attr("data-nazca-id");if(!O){return false}d(O,M,N)})};function D(M,N){if(!M){return false}var O=t[M];for(var P in O.elements){if(O.elements[P]["id"]==N){return O.elements[P]}}return null}function x(M,P){var O=t[M];var N;if(!K(P)){P=[P]}for(i in P){N=o(M,P[i]);if(N){b(M,N)}}return P.length===1?N:false}function o(U,Q){var M=t[U];var X=M.scale_delta;var R,S,W,P,Z,O,N,V;if(typeof Q!="object"){Q=D(U,Q);if(!Q){return false}}var Y=null;S=Q;if(!S.id){S.id=++M.element_last_id;V=M.elements.push(S)}else{Y=M.$nazca_elements.find('.element[data-id="'+S.id+'"]');V=S.css["zIndex"]}S.css={};S.css["zIndex"]=V;S.css["width"]=W=Math.round(S.width*X);S.css["height"]=P=Math.round(S.height*X);S.css["left"]=O=Math.round(S.x*X);S.css["top"]=Z=Math.round(S.y*X);switch(S.type){case f.IMAGE:N="top:"+Z+"px;left:"+O+"px;z-index:"+V+";width:"+W+"px;height:"+P+"px;";if(Y){Y.attr("style",N)}else{Y=y('<div class="element image" data-id="'+S.id+'" style="'+N+'"><img src="'+S.src+'" width="100%" height="100%" /></div>').appendTo(M.$nazca_elements)}break;case f.TEXT:nzc_loadFontStylesheet(S.fontFamily);var T=S.textAlign==3?"right":(S.textAlign==2?"center":"left");N="top:"+Z+"px;left:"+O+"px;z-index:"+V+";width:"+W+"px;height:auto;font-family:"+S.fontFamily+";font-size:"+Math.round(S.fontSize*X)+"px;line-height:"+Math.round(S.fontSize*1.15*X)+"px;color:"+S.color+";text-align:"+T+";";if(Y){Y.attr("style",N).html(nzc_escapeHtml(S.desc))}else{Y=y('<div class="element text" data-id="'+S.id+'" style="'+N+'">'+nzc_escapeHtml(S.desc)+"</div>").appendTo(M.$nazca_elements)}break;default:break}Y.trigger("nzc_draw");return Y}function H(M,N,Q,R){var O=t[M];for(var P in O.elements){if(O.elements[P]["id"]==N){if(Q!==null&&typeof Q==="object"){y.extend(true,O.elements[P],Q)}else{O.elements[P][Q]=R}return true}}return false}function A(M,O){var P=t[M];for(var Q in P.elements){if(P.elements[Q]["id"]==O){P.$nazca_editor_controls.hide();P.$nazca_resize_wrap.hide();P.elements.splice(Q,1);var N=P.$nazca_elements.find('.element[data-id="'+O+'"]');N.trigger("nzc_remove").remove();P.active_element_id=0;return true}}return false}function d(M,N,S){var P=t[M];var R=false;var O;var Q=s(M,N);if(Q!==false){O=C(M,Q,S);if(O!==false){p(P.elements,Q,O);a(M);return true}}return R}function C(U,M,V){var N=t[U];var X=false;var W;var T=N.elements.length;var O,S,P;var Q=N.elements[M];if(Q.type==f.TEXT){Q.height=Math.round(N.$nazca_elements.find('.element[data-id="'+Q.id+'"]').height()/N.scale_delta)}if(V=="back"&&M>0){O=M-1;S=0}else{if(V=="forward"&&M<T-1){O=M+1;S=T-1}}for(var R=O;(V=="back"?R>=S:R<=S);(V=="back"?R--:R++)){P=N.elements[R];if(k(Q,P)){return R}}return false}function s(M,N){var P=t[M];var S;var R=false;var O;for(var Q in P.elements){Q=parseInt(Q);if(P.elements[Q]["id"]==N){return Q}}return false}function a(N){var O=t[N];var M;for(var P in O.elements){P=parseInt(P);_e1=O.elements[P];_e1.css["zIndex"]=P+1;O.$nazca_elements.find('.element[data-id="'+_e1.id+'"]').css({zIndex:_e1.css["zIndex"]});if(O.active_element_id==_e1.id){O.$nazca_resize_wrap.css({zIndex:_e1.css["zIndex"]})}}}function L(R,T){var O=t[R];var P=O.resize_wrap_border_width;var U=O.editor_controls_height;var N,Q;N=T.attr("data-id");O.active_element_id=N;Q=D(R,N);var S,M;S=Q.css["width"]+P*2;M=Q.css["height"]+P*2;O.$nazca_resize_wrap.css({width:S,height:M,top:Q.css["top"]-P,left:Q.css["left"]-P,zIndex:Q.css["zIndex"]});F(R);O.$nazca_resize_wrap.show();h(R);B(R,Q.type)}function b(M,O){var P=t[M];var R=P.$nazca_elements.get(0);var T=P.resize_wrap_border_width;var Q=P.editor_controls_height;var S,N;S=O.attr("data-id");N=D(M,S);n(O,{container:R,onDragStart:function(){L(M,O)},onDrag:function(U){N.css["left"]=U.position[0];N.css["top"]=U.position[1];O.css({left:N.css["left"],top:N.css["top"]});H(M,P.active_element_id,{x:Math.round(U.position[0]/P.scale_delta),y:Math.round(U.position[1]/P.scale_delta)});P.$nazca_resize_wrap.css({left:U.position[0]-T,top:U.position[1]-T});P.$nazca_editor_controls.css({left:U.position[0]-T,top:U.position[1]-T-Q,display:"none"});g(M)},onDragEnd:function(U){P.$nazca_editor_controls.show();m(M)}})}function B(N,M){var O=t[N];j(N,["top-left","top-right","bottom-left","bottom-right","left","right"]);O.$nazca_resize_wrap.removeClass("nazca-wh-resizable nazca-w-resizable");if(M==f.IMAGE){l(N,["top-left","top-right","bottom-left","bottom-right"]);O.$nazca_resize_wrap.addClass("nazca-wh-resizable")}else{l(N,["left","right"]);O.$nazca_resize_wrap.addClass("nazca-w-resizable")}}function j(M,P){var N=t[M];if(!K(P)){P=[P]}for(var O in P){c(N.$nazca_resize_wrap.find("."+P[O]))}}function l(T,V){var P=t[T];var O=P.active_element_id;var Q=D(T,O);var W=P.$nazca_elements.find('.element[data-id="'+O+'"]');if(!K(V)){V=[V]}var N,X,M,U,S;var Y;for(var R in V){Y=V[R];(function(aa){var Z=P.$nazca_resize_wrap.find("."+aa);n(Z,{draggable:W.get(0),container:P.$nazca_elements.get(0),onDragStart:function(){N=W.width();X=W.height();M=Math.sqrt(N*N+X*X);S=N/X;P.$nazca_editor_controls.hide()},onDrag:function(ah){var ac=null,ab=null;switch(aa){case"top-left":ac=N-ah.distance[0];ab=X-ah.distance[1];break;case"top-right":ac=N+ah.distance[0];ab=X-ah.distance[1];break;case"bottom-left":ac=N-ah.distance[0];ab=X+ah.distance[1];break;case"bottom-right":ac=N+ah.distance[0];ab=X+ah.distance[1];break;case"left":ac=N-ah.distance[0];break;case"right":ac=N+ah.distance[0];break;default:c(Z);return false}if(P.opts.ratio_lock&&ab!==null){var aj=Math.sqrt(ac*ac+ab*ab);ac=N*(aj/M);ab=ac/S}if(ac<=P.opts.resize_width_limit||(ab<=P.opts.resize_height_limit&&ab!==null)){return false}var ad={width:ac+2*P.resize_wrap_border_width,height:(ab!==null?ab:W.height())+2*P.resize_wrap_border_width};var ae={};switch(aa){case"top-left":Q.css["left"]=Q.css["left"]+Q.css["width"]-ac;Q.css["top"]=Q.css["top"]+Q.css["height"]-ab;ad.left=Q.css["left"]-P.resize_wrap_border_width;ad.top=Q.css["top"]-P.resize_wrap_border_width;ae.left=Q.css["left"];ae.top=ad.top-P.editor_controls_height;break;case"top-right":Q.css["top"]=Q.css["top"]+Q.css["height"]-ab;ad.top=Q.css["top"]-P.resize_wrap_border_width;ae.top=ad.top-P.editor_controls_height;break;case"bottom-left":Q.css["left"]=Q.css["left"]+Q.css["width"]-ac;ad.left=Q.css["left"]-P.resize_wrap_border_width;ae.left=Q.css["left"];break;case"left":Q.css["left"]=Q.css["left"]+Q.css["width"]-ac;ad.left=Q.css["left"]-P.resize_wrap_border_width;ae.left=Q.css["left"];default:break}Q.css["width"]=ac;Q.css["height"]=ab!==null?ab:"auto";P.$nazca_resize_wrap.css(ad);W.css(Q.css);P.$nazca_editor_controls.css(ae);var ag={};var ai,ak,af;for(var ai in Q.css){af=(ai=="left"?"x":(ai=="top"?"y":ai));ak=Math.round(Q.css[ai]/P.scale_delta);ag[af]=ak}H(T,P.active_element_id,ag);W.trigger("nzc_resize",[Q.css]);g(T)},onDragEnd:function(){P.$nazca_editor_controls.show();m(T)}})})(Y)}}function h(M){var O=t[M];var P=O.active_element_id;var N=D(M,P);var Q=O.$nazca_resize_wrap.find(".nazca-resize-draggable");c(Q);Q.nzc_textarea("remove");if(N.type==f.TEXT){Q.nzc_textarea("init",P)}else{n(Q,{draggable:O.$nazca_resize_wrap.get(0),container:O.$nazca_elements.get(0),onDrag:function(R){N.css["left"]=R.position[0];N.css["top"]=R.position[1];O.$nazca_elements.find('.element[data-id="'+P+'"]').css({left:N.css["left"]+O.resize_wrap_border_width,top:N.css["top"]+O.resize_wrap_border_width});H(M,O.active_element_id,{x:Math.round((N.css["left"]+O.resize_wrap_border_width)/O.scale_delta),y:Math.round((N.css["top"]+O.resize_wrap_border_width)/O.scale_delta)});O.$nazca_resize_wrap.css({left:N.css["left"],top:N.css["top"]});O.$nazca_editor_controls.css({left:N.css["left"],top:N.css["top"]-O.editor_controls_height,display:"none"});g(M)},onDragEnd:function(R){O.$nazca_editor_controls.show();m(M)}})}}function F(M){var O=t[M];var P=O.active_element_id;var N=D(M,P);O.$nazca_editor_controls.show();O.$nazca_editor_controls.css({left:N.css["left"]-O.resize_wrap_border_width,top:N.css["top"]-O.resize_wrap_border_width-O.editor_controls_height});O.$nazca_editor_controls.nzc_image_controls("remove");O.$nazca_editor_controls.nzc_text_controls("remove");if(N.type==f.IMAGE){O.$nazca_editor_controls.nzc_image_controls("init",P)}else{O.$nazca_editor_controls.nzc_text_controls("init",P)}O.$nazca_editor_controls.css({position:"absolute",width:O.$nazca_editor_controls.css({position:"fixed",width:"auto"}).outerWidth()})}function g(M){var O=t[M];var Q=O.active_element_id;var N=D(M,Q);var P=50;y.each(O.$nazca_align_controls.find(".vertical"),function(T,R){var U=y(this);var S={height:N.css["height"]+O.resize_wrap_border_width*2+P,top:N.css["top"]-P/2,left:N.css["left"]};if(U.hasClass("na-vc")){S.left=S.left+N.css["width"]/2}else{if(U.hasClass("na-vr")){S.left=S.left+N.css["width"]}}U.css(S).addClass("on")})}function m(M){var N=t[M];N.$nazca_align_controls.find(".on").removeClass("on")}function n(M,N){var O=N;if(I){M.bind("touchstart",O,u)}else{M.bind("dragstart",function(){return false});M.bind("mousedown",O,u)}}function c(M){if(I){M.unbind("touchstart")}else{M.unbind("dragstart");M.unbind("mousedown")}}function u(Y){var ad=false;var P=Y.data.draggable||this;var W=y(P);var aa=Y.data.container||W.parent().get(0);var R=Y.data.onDragStart||null;var Z=Y.data.onDrag||null;var O=Y.data.onDragEnd||null;var ae=q(Y.originalEvent);var ac=v(P);var S=v(aa);var ag=ae.pageX-ac.left;var af=ae.pageY-ac.top;var N=ae.pageX;var M=ae.pageY;var X=N-ag-S.left;var Q=M-af-S.top;var ab=X;var V=Q;if(R){R.call(P)}var U=function(ah){if(I){ah.preventDefault();ah.stopPropagation()}ad=true;ah=q(ah.originalEvent);N=ah.pageX;M=ah.pageY;ab=N-ag-S.left;V=M-af-S.top;if(Z){Z.call(P,{position:[ab,V],distance:[ab-X,V-Q]})}else{P.style.left=ab+"px";P.style.top=V+"px";P.style.right="auto";P.style.bottom="auto"}};var T=function(ah){ad=false;if(I){y("body").unbind("touchmove.nazcaEleDrag",U);y("body").unbind("touchend.nazcaEleDrag",T)}else{y(document).unbind("mousemove.nazcaEleDrag",U);y(document).unbind("mouseup.nazcaEleDrag",T)}if(O){O.call(P,{position:[ab,V],distance:[ab-X,V-Q]})}};if(I){y("body").bind("touchmove.nazcaEleDrag",U);y("body").bind("touchend.nazcaEleDrag",T)}else{y(document).bind("mousemove.nazcaEleDrag",U);y(document).bind("mouseup.nazcaEleDrag",T)}}function q(O){O=O||window.event;if(!O.target){O.target=O.srcElement}if(typeof(O.touches)!="undefined"&&O.touches.length==1){delete O.pageX;delete O.pageY;O.pageX=O.touches[0].pageX;O.pageY=O.touches[0].pageY}else{if(O.pageX==null&&O.clientX!=null){var N=document.documentElement;var M=document.body;O.pageX=O.clientX+(N.scrollLeft||M&&M.scrollLeft||0);O.pageX-=N.clientLeft||0;O.pageY=O.clientY+(N.scrollTop||M&&M.scrollTop||0);O.pageY-=N.clientTop||0}if(!O.which&&O.button){O.which=O.button&1?1:(O.button&2?3:(O.button&4?2:0))}}return O}function v(P){var S=P.getBoundingClientRect();var T=document.body;var N=document.documentElement;var M=window.pageYOffset||N.scrollTop||T.scrollTop;var Q=window.pageXOffset||N.scrollLeft||T.scrollLeft;var R=N.clientTop||T.clientTop||0;var U=N.clientLeft||T.clientLeft||0;var V=S.top+M-R;var O=S.left+Q-U;return{top:Math.round(V),left:Math.round(O)}}function k(R,Q){var N=R.x;var T=R.y;var M=R.x+R.width;var S=R.y+R.height;var V=Q.x;var P=Q.y;var U=Q.x+Q.width;var O=Q.y+Q.height;return !(V>M||U<N||P>S||O<T)}function K(M){return Object.prototype.toString.call(M)==="[object Array]"?true:false}function p(P,O,M){if(M>=P.length){var N=M-P.length;while((N--)+1){P.push(undefined)}}return P.splice(M,0,P.splice(O,1)[0])}}(jQuery));(function(d){var a="0.1.0";var b={};d.fn.nzc_image_controls=function(e){if(typeof(e)==="object"||!e){return b.init.apply(this,arguments)}else{if(b[e]){return b[e].apply(this,Array.prototype.slice.call(arguments,1))}else{d.error("Method "+e+" does not exists.")}}};b.init=function(e){return this.each(function(){if(!e){return false}var f=d(this);if(f.hasClass("nazca-image-controls")){return false}f.addClass("nazca-image-controls");f.attr("data-element-id",e);var g;g='<ul class="nav nav-nzc-controls"><li><a class="nzc-control" data-type="delete"><i class="fa fa-trash"></i></a></li><li><a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-caret-down"></i></a><ul class="dropdown-menu" role="menu"><li><a class="nzc-control" data-type="move" data-value="forward">Move forward</a></li><li><a class="nzc-control" data-type="move" data-value="back">Move back</a></li></ul></li></ul>';f.html(g);c(f)})};b.remove=function(e){return this.each(function(){var f=d(this);if(!f.hasClass("nazca-image-controls")){return false}f.removeClass("nazca-image-controls");f.removeAttr("data-element-id");f.empty()})};function c(e){var g=e.attr("data-element-id");var f=e.parents(".nazca-workspace");e.find(".nzc-control").click(function(l){var k=d(this);var j=k.attr("data-type");var h=k.attr("data-value");switch(j){case"delete":f.nazca("removeElement",g);break;case"move":switch(h){case"forward":f.nazca("moveElement",g,"forward");break;case"back":f.nazca("moveElement",g,"back");break;default:break}break;default:break}})}}(jQuery));(function(f){var a="0.1.0";var c={};f.fn.nzc_textarea=function(g){if(typeof(g)==="object"||!g){return c.init.apply(this,arguments)}else{if(c[g]){return c[g].apply(this,Array.prototype.slice.call(arguments,1))}else{f.error("Method "+g+" does not exists.")}}};c.init=function(g){return this.each(function(){if(!g){return false}var h=f(this);if(h.hasClass("nazca-textarea-wrap")){return false}h.addClass("nazca-textarea-wrap").attr("data-element-id",g).css("cursor","default");var j=f('<textarea id="nzc_t'+Math.round((Math.random()*(999999-0)+0))+'"></textarea>').appendTo(h);b(j,g);d(j,g)})};c.remove=function(){return this.each(function(){var g=f(this);if(!g.hasClass("nazca-textarea-wrap")){return false}e(g)})};function e(h,l){var j=h.parents(".nazca-workspace");var g=h.attr("data-element-id");var k=j.find('.element[data-id="'+g+'"]');if(typeof(l)=="undefined"){l=h.children("textarea")}f('.nzc_shadow[data-id="'+l.attr("id")+'"]').remove();j.nazca("setElementAttr",g,{desc:l.val()});k.html(nzc_escapeHtml(l.val()));h.removeAttr("data-element-id").removeClass("nazca-textarea-wrap").css("cursor","move");l.remove();f(window).unbind("resize.nzc_textarea");if(k.length){k.unbind("nzc_remove.nzc_textarea");k.unbind("nzc_resize.nzc_textarea");k.unbind("nzc_draw.nzc_textarea");k.css("visibility","visible")}}function b(n,h){var k=n.parents(".nazca-workspace");var m=k.find('.element[data-id="'+h+'"]');if(!m.length){return false}var g=k.nazca("getElementData",h);var l={color:m.css("color"),fontFamily:m.css("fontFamily"),fontSize:m.css("fontSize"),lineHeight:m.css("lineHeight"),textAlign:m.css("textAlign")};n.val(g.desc).css(l);m.css("visibility","hidden");var j=f('.nzc_shadow[data-id="'+n.attr("id")+'"]');if(!j.length){j=f('<div class="nzc_shadow"></div>').appendTo(document.body);j.attr("data-id",n.attr("id"))}j.css({position:"absolute",top:-10000,left:-10000,width:m.width(),fontSize:l.fontSize,fontFamily:l.fontFamily,lineHeight:l.lineHeight,resize:"none","word-wrap":"break-word"});return true}function d(n,g){var l=n.parents(".nazca-workspace");var m=l.find('.element[data-id="'+g+'"]');var j=n.parents(".nazca-resize-wrap");var h=f('.nzc_shadow[data-id="'+n.attr("id")+'"]');var k=function(p){var q=nzc_escapeHtml(n.val());if(p&&p.data&&p.data.event==="keydown"&&p.keyCode===13){q+="<br/>&nbsp;"}h.css("width",n.width());h.html(q);var o=h.height();if(o<=0){o=parseInt(n.css("lineHeight"))}n.height(o);j.height(o)};k(null);n.keydown({event:"keydown"},k).bind("change keyup",function(o){k(o);n.parents(".nazca-workspace").nazca("setElementAttr",g,{desc:n.val()});m.html(nzc_escapeHtml(n.val()))});f(window).bind("resize.nzc_textarea",k);m.bind("nzc_resize.nzc_textarea",function(o,p){k()});m.bind("nzc_draw.nzc_textarea",function(){b(n,g);k(null)}).bind("nzc_remove.nzc_textarea",function(){e(n.parent(),n)})}}(jQuery));var nzc_font_sizes=[12,14,16,18,21,24,28,32,36,42,48,56,64,72,80,88,96,104,120,144];var nzc_font_colors=["#000000","#ffffff","#1e84ab","#f1c40f","#009900","#cc0000"];(function(d){var a="0.1.0";var b={};d.fn.nzc_text_controls=function(e){if(typeof(e)==="object"||!e){return b.init.apply(this,arguments)}else{if(b[e]){return b[e].apply(this,Array.prototype.slice.call(arguments,1))}else{d.error("Method "+e+" does not exists.")}}};b.init=function(e){return this.each(function(){if(!e){return false}var f=d(this);if(f.hasClass("nazca-text-controls")){return false}f.addClass("nazca-text-controls");f.attr("data-element-id",e);var g;g='<ul class="nav nav-nzc-controls"><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-font"></i> Font <span class="caret"></span></a><ul class="nzc-t-font-dropdown dropdown-menu" role="menu">';for(var h in nzc_fonts){g+='<li><a class="nzc-control" data-type="font" data-value="'+h+'">'+nzc_fonts[h][0]+"</a></li>"}g+='</ul></li><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-text-height"></i> <span class="caret"></span></a><ul class="nzc-t-fsize-dropdown dropdown-menu" role="menu">';for(var h in nzc_font_sizes){g+='<li><a class="nzc-control" data-type="font_size" data-value="'+nzc_font_sizes[h]+'">'+nzc_font_sizes[h]+"px</a></li>"}g+='</ul></li><li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-adjust"></i> Color <span class="caret"></span></a><ul class="nzc-t-color-dropdown dropdown-menu" role="menu">';for(var h in nzc_font_colors){g+='<li><a class="nzc-control" data-type="color" data-value="'+nzc_font_colors[h]+'"><i style="display:block; width:25px; height:25px; background-color:'+nzc_font_colors[h]+'; border-radius:50%; box-shadow: inset 2px 2px 1px rgba(0,0,0,.15),inset -1px -1px 0 rgba(255,255,255,.25);"></i></a></li>'}g+='</ul></li><li><a class="nzc-control" data-type="delete"><i class="fa fa-trash"></i></a></li><li><a class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-caret-down"></i></a><ul class="dropdown-menu" role="menu"><li><a class="nzc-control" data-type="align" data-value="left"><i class="fa fa-align-left"> Left</i></a></li><li><a class="nzc-control" data-type="align" data-value="center"><i class="fa fa-align-center"></i> Center</a></li><li><a class="nzc-control" data-type="align" data-value="right"><i class="fa fa-align-right"></i> Right</a></li><li class="divider"></li><li><a class="nzc-control" data-type="move" data-value="forward">Move forward</a></li><li><a class="nzc-control" data-type="move" data-value="back">Move back</a></li></ul></li></ul>';f.html(g);c(f)})};b.remove=function(e){return this.each(function(){var f=d(this);if(!f.hasClass("nazca-text-controls")){return false}f.removeClass("nazca-text-controls");f.removeAttr("data-element-id");f.empty()})};function c(e){var g=e.attr("data-element-id");var f=e.parents(".nazca-workspace");e.find(".nzc-control").click(function(n){var m=d(this);var l=m.attr("data-type");var k=m.attr("data-value");switch(l){case"font":var j=parseInt(k);nzc_loadFontStylesheet(j);f.nazca("setElementAttr",g,{fontFamily:nzc_fonts[j][0]}).nazca("redrawElement",g);break;case"font_size":f.nazca("setElementAttr",g,{fontSize:k}).nazca("redrawElement",g);break;case"color":f.nazca("setElementAttr",g,{color:k}).nazca("redrawElement",g);break;case"align":var h;switch(k){case"left":h=nzc_textAlign.LEFT;break;case"center":h=nzc_textAlign.CENTER;break;case"right":h=nzc_textAlign.RIGHT;break;default:break}f.nazca("setElementAttr",g,{textAlign:h}).nazca("redrawElement",g);break;case"delete":f.nazca("removeElement",g);break;case"move":switch(k){case"forward":f.nazca("moveElement",g,"forward");break;case"back":f.nazca("moveElement",g,"back");break;default:break}break;default:break}})}}(jQuery));